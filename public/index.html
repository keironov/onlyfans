<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OnlyFans Dashboard</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <header>
    <h1>Табло OnlyFans</h1>
    <nav>
      <ul>
        <li><a href="#report-form">Отчеты</a></li>
        <li><a href="#feedback-form">Обратная связь</a></li>
        <li><a href="#global-stats">Статистика</a></li>
        <li><a href="#user-list">Пользователи</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <section id="report-form">
      <h2>Отправить отчет</h2>
      <form id="reportForm">
        <label for="user">Пользователь:</label>
        <input type="text" id="user" name="user" required>
        
        <label for="reason">Причина:</label>
        <input type="text" id="reason" name="reason" required>
        
        <label for="reportText">Текст отчета:</label>
        <textarea id="reportText" name="reportText" required></textarea>
        
        <button type="submit">Отправить отчет</button>
      </form>
      <div id="reportStatus"></div>
    </section>

    <section id="feedback-form">
      <h2>Обратная связь</h2>
      <form id="feedbackForm">
        <label for="manager">Менеджер:</label>
        <input type="text" id="manager" name="manager" required>
        
        <label for="feedbackUser">Пользователь:</label>
        <input type="text" id="feedbackUser" name="feedbackUser" required>
        
        <label for="feedbackText">Текст отзыва:</label>
        <textarea id="feedbackText" name="feedbackText" required></textarea>
        
        <button type="submit">Отправить отзыв</button>
      </form>
      <div id="feedbackStatus"></div>
    </section>

    <section id="global-stats">
      <h2>Глобальная статистика</h2>
      <button onclick="fetchStats()">Получить статистику</button>
      <div id="stats"></div>
    </section>

    <section id="user-list">
      <h2>Пользователи</h2>
      <button onclick="fetchUsers()">Получить пользователей</button>
      <div id="users"></div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 OnlyFans Dashboard</p>
  </footer>

  <script>
    // Отправка отчета
    document.getElementById('reportForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const user = document.getElementById('user').value;
      const reason = document.getElementById('reason').value;
      const reportText = document.getElementById('reportText').value;

      axios.post('/api/reports', { user, reason, reportText })
        .then(response => {
          document.getElementById('reportStatus').textContent = 'Отчет отправлен успешно!';
        })
        .catch(error => {
          document.getElementById('reportStatus').textContent = 'Ошибка при отправке отчета!';
        });
    });

    // Отправка отзыва
    document.getElementById('feedbackForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const manager = document.getElementById('manager').value;
      const user = document.getElementById('feedbackUser').value;
      const feedbackText = document.getElementById('feedbackText').value;

      axios.post('/api/feedback', { manager, user, feedbackText })
        .then(response => {
          document.getElementById('feedbackStatus').textContent = 'Отзыв отправлен успешно!';
        })
        .catch(error => {
          document.getElementById('feedbackStatus').textContent = 'Ошибка при отправке отзыва!';
        });
    });

    // Получить глобальную статистику
    function fetchStats() {
      axios.get('/api/stats/global')
        .then(response => {
          const stats = response.data;
          document.getElementById('stats').innerHTML = `
            <p>Общее количество отчетов: ${stats.totalReports}</p>
          `;
        })
        .catch(error => {
          document.getElementById('stats').textContent = 'Ошибка при получении статистики';
        });
    }

    // Получить список пользователей
    function fetchUsers() {
      axios.get('/api/users')
        .then(response => {
          const users = response.data.users;
          let userHtml = '<ul>';
          users.forEach(user => {
            userHtml += `<li>${user.name} (${user.email})</li>`;
          });
          userHtml += '</ul>';
          document.getElementById('users').innerHTML = userHtml;
        })
        .catch(error => {
          document.getElementById('users').textContent = 'Ошибка при получении пользователей';
        });
    }
  </script>
</body>
</html>
