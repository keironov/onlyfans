<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Team Dashboard</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="dark-theme">
<h1>Team Dashboard</h1>

<div id="team"></div>

<h2>Feedback</h2>
<form id="feedbackForm">
  <input type="text" id="username" placeholder="Username">
  <input type="text" id="message" placeholder="Сообщение">
  <button type="submit">Отправить</button>
</form>

<script>
async function loadTeam() {
  const res = await fetch('/team');
  const data = await res.json();
  const container = document.getElementById('team');
  container.innerHTML = '<table border="1"><tr><th>Username</th><th>Отчёты</th><th>DA%</th><th>NET%</th></tr>'
    + data.map(u => `<tr><td>${u.username}</td><td>${u.reports}</td><td>${(u.da*100).toFixed(1)}%</td><td>${(u.net*100).toFixed(1)}%</td></tr>`).join('')
    + '</table>';
}
loadTeam();

document.getElementById('feedbackForm').addEventListener('submit', async e=>{
  e.preventDefault();
  const username = document.getElementById('username').value;
  const message = document.getElementById('message').value;
  await fetch('/feedback',{method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({username,message})});
  alert('Отправлено');
});
</script>
</body>
</html>
